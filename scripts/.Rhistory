load("E:/Lisa Holsten/CoCena - Theo/dir_0.811/.RData")
library(clusterProfiler)
library(combinat)
library(dplyr)
library(ggplot2)
library(graphics)
library(grDevices)
library(grid)
library(igraph)
library(pcaGoPromoter.Hs.hg19)
library(pheatmap)
library(purrr)
library(stringi)
library(tidyr)
library(tidyverse)
library(utils)
library(ggnetwork)        #LISA: added for network_visualization
library(intergraph)
source(paste0(working_directory,"scripts/", "network_generation.R" ))
ig = igraph::graph_from_data_frame(filt_cutoff_data, directed=FALSE)
return_network_pers <- network_layout(igraph.object = igraph_object_pers,
use.layout = "cytoscape",           # option: "cytoscape", open cytoscape program!
select.subnetwork = NULL,           # option: choose specific cluster (e.g. "cluster1)
min.nodes.number = min_nodes_number_for_network)  # from input_file
igraph_object_pers <- return_network_pers$graph_object
layout_matrix_pers <- return_network_pers$layout
network_object_pers <- generate_network_object(graph_object = igraph_object_pers,
use_layout = layout_matrix_pers)
# Network visualization -------------------------------------------------------------------------------
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
# Select parameters for the visualization of network_object_pers:
visualize_network(network = network_object_pers,
color.by = "TF",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = "TCF4",             #Options: Provide vector of gene symbols
plot.subnetwork = NULL,          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "cytoscape",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
function (file, local = FALSE, echo = verbose, print.eval = echo,
exprs, spaced = use_file, verbose = getOption("verbose"),
prompt.echo = getOption("prompt"), max.deparse.length = 150,
width.cutoff = 60L, deparseCtrl = "showAttributes", chdir = FALSE,
encoding = getOption("encoding"), continue.echo = getOption("continue"),
skip.echo = 0, keep.source = getOption("keep.source"))
source(paste0(working_directory,"scripts/", "network_generation.R" ))
source(paste0(working_directory,"scripts/", "network_generation.R" ))
ig = igraph::graph_from_data_frame(filt_cutoff_data, directed=FALSE)
source(paste0(working_directory,"scripts/", "network_generation.R" ))
ig = igraph::graph_from_data_frame(filt_cutoff_data, directed=FALSE)
return_network_pers <- network_layout(igraph.object = ig,
use.layout = "cytoscape",           # option: "cytoscape", open cytoscape program!
select.subnetwork = NULL,           # option: choose specific cluster (e.g. "cluster1)
min.nodes.number = min_nodes_number_for_network)  # from input_file
igraph_object_pers <- return_network_pers$graph_object
layout_matrix_pers <- return_network_pers$layout
network_object_pers <- generate_network_object(graph_object = igraph_object_pers,
use_layout = layout_matrix_pers)
# Network visualization -------------------------------------------------------------------------------
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
# Select parameters for the visualization of network_object_pers:
visualize_network(network = network_object_pers,
color.by = "TF",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = "TCF4",             #Options: Provide vector of gene symbols
plot.subnetwork = NULL,          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "cytoscape",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
getwd()
visualize_network(network = network_object_pers,
color.by = "cluster",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = NULL,          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "cytoscape",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
setwd("E:/Lisa HolstenC/oCena - Theo/dir_0.811")
getwd()
setwd("E:/Lisa HolstenC/oCena - Theo/dir_0.811")
dev.off()
setwd("E:/Lisa HolstenC/oCena - Theo/dir_0.811")
setwd("E:/Lisa HolstenC/oCena - Theo/dir_0.811")
ggsci::pal_jama()[5]
ggsci::pal_jama()
ggsci::pal_jama(palette = c("default"))
show_col(ggsci::pal_jama("default)) (5)
show_col(ggsci::pal_jama("default")) (5)
ggsci::pal_jco()
ggsci::pal_jco(5)
ggsci::pal_jco()[5]
ggsci::pal_jco("nrc")(5)
ggsci::pal_jco("default")(5)
ggsci::pal_jama("default")(5)
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
visualize_network(network = network_object_pers,
color.by = "cluster",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = NULL,          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "cytoscape",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
visualize_network(network = network_object_pers,
color.by = "TF",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = NULL,          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "cytoscape",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
visualize_network(network = network_object_pers,
color.by = "TF",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = NULL,          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "cytoscape",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
visualize_network(network = network_object_pers,
color.by = "TF",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = NULL,          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "cytoscape",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
View(network_object_pers)
network_object_pers[network_object_pers$cluster_name == "Cluster1", ]
network_object_pers[network_object_pers$cluster_name == "Cluster1", "Gene"]
network_object_pers[network_object_pers$cluster_name == "Cluster1", "cluster_color"]
network_object_pers[network_object_pers$cluster_name == "Cluster1", ]
View(vertex_meta)
source(paste0(working_directory,"scripts/", "network_generation.R" ))
ig = igraph::graph_from_data_frame(filt_cutoff_data, directed=FALSE)
return_network_pers <- network_layout(igraph.object = ig,
use.layout = "layout_with_fr",           # option: "cytoscape", open cytoscape program!
select.subnetwork = "Cluster1",           # option: choose specific cluster (e.g. "cluster1)
min.nodes.number = min_nodes_number_for_network)  # from input_file
igraph_object_pers <- return_network_pers$graph_object
layout_matrix_pers <- return_network_pers$layout
network_object_pers <- generate_network_object(graph_object = igraph_object_pers,
use_layout = layout_matrix_pers)
# Network visualization -------------------------------------------------------------------------------
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
# Select parameters for the visualization of network_object_pers:
visualize_network(network = network_object_pers,
color.by = "cluster",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = NULL,          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
source(paste0(working_directory,"scripts/", "network_generation.R" ))
ig = igraph::graph_from_data_frame(filt_cutoff_data, directed=FALSE)
return_network_pers <- network_layout(igraph.object = ig,
use.layout = "layout_with_fr",      # option: "cytoscape", open cytoscape program!
select.subnetwork = NULL,           # option: choose specific cluster (e.g. "cluster1)
min.nodes.number = min_nodes_number_for_network)  # from input_file
igraph_object_pers <- return_network_pers$graph_object
layout_matrix_pers <- return_network_pers$layout
network_object_pers <- generate_network_object(graph_object = igraph_object_pers,
use_layout = layout_matrix_pers)
# Network visualization -------------------------------------------------------------------------------
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
# Select parameters for the visualization of network_object_pers:
visualize_network(network = network_object_pers,
color.by = "cluster",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = "Cluster1",          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
min_nodes_number_for_network=10
source(paste0(working_directory,"scripts/", "network_generation.R" ))
ig = igraph::graph_from_data_frame(filt_cutoff_data, directed=FALSE)
return_network_pers <- network_layout(igraph.object = ig,
use.layout = "layout_with_fr",      # option: "cytoscape", open cytoscape program!
select.subnetwork = NULL,           # option: choose specific cluster (e.g. "cluster1)
min.nodes.number = min_nodes_number_for_network)  # from input_file
igraph_object_pers <- return_network_pers$graph_object
layout_matrix_pers <- return_network_pers$layout
network_object_pers <- generate_network_object(graph_object = igraph_object_pers,
use_layout = layout_matrix_pers)
View(network_object_pers)
View(layout_matrix_pers)
V(igraph_object_pers)
source(paste0(working_directory,"scripts/", "network_generation.R" ))
ig_object = igraph::graph_from_data_frame(filt_cutoff_data, directed=FALSE)
return_network_pers <- network_layout(igraph.object = ig_object,
use.layout = "layout_with_fr",      # option: "cytoscape", open cytoscape program!
select.subnetwork = NULL,           # option: choose specific cluster (e.g. "cluster1)
min.nodes.number = min_nodes_number_for_network)  # from input_file
igraph_object_pers <- return_network_pers$graph_object
layout_matrix_pers <- return_network_pers$layout
network_object_pers <- generate_network_object(graph_object = igraph_object_pers,
use_layout = layout_matrix_pers)
# Network visualization -------------------------------------------------------------------------------
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
# Select parameters for the visualization of network_object_pers:
visualize_network(network = network_object_pers,
color.by = "cluster",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = "Cluster1",          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)
source(paste0(working_directory,"scripts/", "network_generation.R" ))
ig_object = igraph::graph_from_data_frame(filt_cutoff_data, directed=FALSE)
return_network_pers <- network_layout(igraph.object = ig_object,
use.layout = "layout_with_fr",      # option: "cytoscape", open cytoscape program!
select.subnetwork = NULL,           # option: choose specific cluster (e.g. "cluster1)
min.nodes.number = min_nodes_number_for_network)  # from input_file
igraph_object_pers <- return_network_pers$graph_object
layout_matrix_pers <- return_network_pers$layout
network_object_pers <- generate_network_object(graph_object = igraph_object_pers,
use_layout = layout_matrix_pers)
# Network visualization -------------------------------------------------------------------------------
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
# Select parameters for the visualization of network_object_pers:
visualize_network(network = network_object_pers,
color.by = "cluster",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = "Cluster1",          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)
visualize_network(network = network_object_pers,
color.by = "cluster",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = "Cluster10",          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
visualize_network(network = network_object_pers,
color.by = "cluster",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = "Cluster10",          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
network[network$cluster_name == plot.subnetwork, ]
network_object_pers[network_object_pers$cluster_name == plot.subnetwork, ]
network_object_pers[network_object_pers$cluster_name == "Cluster10", ]
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
# Select parameters for the visualization of network_object_pers:
visualize_network(network = network_object_pers,
color.by = "cluster",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = "Cluster10",          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)
visualize_network(network = network_object_pers,
color.by = "basic",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = "Cluster10",          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
# Select parameters for the visualization of network_object_pers:
visualize_network(network = network_object_pers,
color.by = "basic",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = "Cluster10",          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
library(clusterProfiler)
library(combinat)
library(dplyr)
library(ggplot2)
library(graphics)
library(grDevices)
library(grid)
library(igraph)
library(pcaGoPromoter.Hs.hg19)
library(pheatmap)
library(purrr)
library(stringi)
library(tidyr)
library(tidyverse)
library(utils)
library(ggnetwork)        #LISA: added for network_visualization
library(intergraph)
source(paste0(working_directory,"scripts/", "network_visualization.R" ))
# Select parameters for the visualization of network_object_pers:
visualize_network(network = network_object_pers,
color.by = "basic",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = "Cluster10",          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
visualize_network(network = network_object_pers,
color.by = "basic",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = NULL,          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
visualize_network(network = network_object_pers,
color.by = "cluster",                 #Options:"basic", "cluster", "TF", "HALLMARK_X", "GFC_X
gene.label = NULL,             #Options: Provide vector of gene symbols
plot.subnetwork = NULL,          #Options: Select subnetwork (e.g. "Cluster1") or NULL to show whole network
use.layout = "layout_with_fr",        #Provide same layout as above, only used to name pdf file accordingly
save.pdf = T)                    #Default: save.pdf = T to plot network in pdf
View(network_object_pers)
network_object_perso[network_object_pers$Gene == "LTF", ]
network_object_pers[network_object_pers$Gene == "LTF", ]
View(vertex_meta)
vertex_meta$color == "white"
vertex_meta[vertex_meta$color == "white", ]
test <- vertex_meta[vertex_meta$color == "white", ]
V(ig)
sum(V(ig) %in% test)
sum(test %in% V(ig))
sum(V(ig_object) %in% test)
test <- vertex_meta[vertex_meta$color == "#6A33C2", ]
sum(V(ig_object) %in% test)
sum(test %in% V(ig))
test <- vertex_meta[vertex_meta$color == "#6A33C2", "gene_n"]
sum(V(ig_object) %in% test)
v(ig_object)
test <- V(ig_object)
V(ig_object)
names(V(ig_object))
test <- vertex_meta[vertex_meta$color == "#6A33C2", "gene_n"]
test %in% names(V(ig_object))
sum(test %in% names(V(ig_object)))
test <- vertex_meta[vertex_meta$color == "white", "gene_n"]
sum(test %in% names(V(ig_object)))
sum(test %in% names(V(igraph_object_pers)))
V(igraph_object_pers)
save.image("E:/Lisa Holsten/CoCena - Theo/dir_0.811/Workspace.RData")
